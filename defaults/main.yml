---
# Builder: docker or podman
dockerfile_builder: docker
dockerfile_builders:
  - podman
  - docker

# Builder template
dockerfile_builder_template: Dockerfile.j2
dockerfile_builder_dockerfile: Dockerfile

# Image name (Ex. "repository/name:tag". It is also the path to
# its context
dockerfile_builder_image: false

# Image source
dockerfile_builder_src: "{{ dockerfile_builder_image }}"

# Dest directory for image context
dockerfile_builder_path:
  "{{ 'build/' + dockerfile_builder_image }}"

# Source template for image Dockerfile
dockerfile_builder_template_src: >-
  "{{ dockerfile_builder_src +
  '/' + dockerfile_builder_template }}"

# Dest template for image Dockerfile
dockerfile_builder_template_dest: >-
    "{{ dockerfile_builder_path +
    '/' + dockerfile_builder_dockerfile }}"

# omit if templates do not change dest
dockerfile_builder_build_omit_when_no_sync: false

# debug build
dockerfile_builder_debug: false

# login and push
# dockerfile_builder_push: true
# dockerfile_builder_username: myusername
# dockerfile_builder_password: mypassword

# Other
dockerfile_builder_template_files: "{{ query('fileglob', dockerfile_builder_src + '/*.j2') }}"
dockerfile_builder_rsync_opts: "{%- if dockerfile_builder_template_files -%}{%- for template_file in dockerfile_builder_template_files -%}--exclude={{ template_file | basename }},--exclude={{ template_file | basename | regex_replace('.j2$', '') }}{% if not loop.last %},{%- endif -%}{%- endfor -%}{%- endif -%}"
